{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap fd887fe9e30d3369b77d","webpack:///./material/components/django-material-profile-page.js","webpack:///external \"frontend\"","webpack:///./material/components/dmc-profile-page/index.js","webpack:///external \"Stimulus\"","webpack:///./node_modules/smartcrop/smartcrop.js","webpack:///external \"Turbolinks\""],"names":["root","factory","exports","module","require","define","amd","self","this","__WEBPACK_EXTERNAL_MODULE_1__","__WEBPACK_EXTERNAL_MODULE_3__","__WEBPACK_EXTERNAL_MODULE_5__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","__WEBPACK_IMPORTED_MODULE_0_frontend__","register","__WEBPACK_IMPORTED_MODULE_1__dmc_profile_page__","onChangeAvatarClick","event","files","target","length","type","indexOf","_this","showError","reader","FileReader","onload","readerEvent","image","Image","_crop","then","cropCanvas","_upload","catch","error","_showError","message","src","result","readAsDataURL","__WEBPACK_IMPORTED_MODULE_0_stimulus__","_uploadButtonEl","element","querySelector","_formEl","addEventListener","removeEventListener","onSuccess","__WEBPACK_IMPORTED_MODULE_1_smartcrop___default","a","crop","minScale","width","height","document","createElement","getContext","drawImage","topCrop","x","y","canvas","_this2","classList","toggle","xhr","XMLHttpRequest","open","window","location","search","setRequestHeader","getResponseHeader","snapshot","Turbolinks","Snapshot","wrap","response","href","controller","adapter","hideProgressBar","cache","put","visit","action","clearCache","status","__WEBPACK_IMPORTED_MODULE_2_turbolinks___default","disable","onerror","uploadButton_","showProgressBarAfterDelay","toBlob","blob","formData","FormData","append","send","timeout","arguments","undefined","snackbarEvent","CustomEvent","detail","dispatchEvent","__WEBPACK_AMD_DEFINE_RESULT__","smartcrop","applyBoost","boost","options","output","od","data","w","x0","x1","y0","y1","weight","score","saturation","skin","total","downSample","scoreDownSample","invDownSample","outputHeightDownSample","outputWidthDownSample","outputWidth","importance","skinBias","saturationBias","detailWeight","skinWeight","saturationWeight","boostWeight","outsideImportance","px","abs","py","dx","Math","max","edgeRadius","dy","edgeWeight","sqrt","ruleOfThirds","thirds","skinColor","r","g","b","mag","rd","gd","bd","ImgData","Uint8ClampedArray","input","factor","idata","iwidth","floor","ifactor2","mr","mg","mb","v","u","j","defaultCanvasFactory","h","canvasImageOperations","canvasFactory","naturalWidth","naturalHeight","ctx","Promise","resolve","resample","getData","id","getImageData","Error","DEFAULTS","aspect","cropWidth","cropHeight","skinBrightnessMin","skinBrightnessMax","skinThreshold","saturationBrightnessMin","saturationBrightnessMax","saturationThreshold","step","scaleStep","maxScale","prescale","imageOperations","debug","inputImage","options_","callback","extend","iop","scale","min","map","lightness","sample","edgeDetect","cie","isSkinColor","isSkinBrightness","skinDetect","sat","acceptableLightness","saturationDetect","applyBoosts","scoreOutput","topScore","Infinity","crops","results","minDimension","push","generateCrops","iLen","debugOutput","debugOptions","debugTopCrop","analyse","isAvailable","_downSample","_canvasImageOperations","ceil","arg","maximum","minumum"],"mappings":"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","file":"js/django-material-profile-page.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"frontend\"), require(\"Stimulus\"), require(\"Turbolinks\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"frontend\", \"Stimulus\", \"Turbolinks\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"frontend\"] = factory(require(\"frontend\"), require(\"Stimulus\"), require(\"Turbolinks\"));\n\telse\n\t\troot[\"frontend\"] = factory(root[\"frontend\"], root[\"Stimulus\"], root[\"Turbolinks\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_5__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap fd887fe9e30d3369b77d","import {application} from 'frontend';\nimport DMCProfileAvatar from './dmc-profile-page';\n\napplication.register('dmc-profile-avatar', DMCProfileAvatar);\n\n\n\n// WEBPACK FOOTER //\n// ./material/components/django-material-profile-page.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"frontend\"\n// module id = 1\n// module chunks = 0","/* eslint-env browser */\n\nimport {Controller} from 'stimulus';\nimport smartcrop from 'smartcrop';\nimport Turbolinks from 'turbolinks';\n\n\nexport default class extends Controller {\n  initialize() {\n    this._uploadButtonEl = this.element.querySelector('.dmc-profile-avatar__change');\n    this._formEl = this.element.querySelector('form');\n  }\n\n  connect() {\n    this._uploadButtonEl.addEventListener('change', this.onChangeAvatarClick);\n  }\n\n  disconnect() {\n    this._uploadButtonEl.removeEventListener('change', this.onChangeAvatarClick);\n  }\n\n  onChangeAvatarClick = (event) => {\n    let files = event.target.files;\n    if (files.length === 0 || files[0].type.indexOf('image') === -1) {\n      this.showError('No images selected');\n    }\n\n    let reader = new FileReader();\n    reader.onload = (readerEvent) => {\n      let image = new Image();\n      image.onload = () => {\n        this._crop(image).then((cropCanvas) => {\n          this._upload(cropCanvas);\n        }).catch((error) => {\n          this._showError(error.message || 'Image cropping error');\n        });\n      };\n      image.src = readerEvent.target.result;\n    };\n    reader.readAsDataURL(files[0]);\n  };\n\n  _crop(image, onSuccess) {\n    let options = {\n      minScale: 1,\n      width: 256,\n      height: 256,\n    };\n    return smartcrop.crop(image, options).then((result) => {\n      let cropCanvas = document.createElement('canvas');\n      cropCanvas.width = 256;\n      cropCanvas.height = 256;\n      cropCanvas.getContext('2d').drawImage(\n        image,\n        result.topCrop.x, result.topCrop.y, result.topCrop.width, result.topCrop.height,\n        0, 0, 256, 256\n      );\n      return cropCanvas;\n    });\n  }\n\n  _upload(canvas) {\n    this._uploadButtonEl.classList.toggle('dmc-profile-avatar__change--disabled');\n\n    let xhr = new XMLHttpRequest();\n    xhr.open('POST', window.location.search, true);\n    xhr.setRequestHeader('Turbolinks-Referrer', window.location);\n\n    xhr.onload = (event) => {\n      let location = xhr.getResponseHeader('turbolinks-location');\n      let snapshot = window.Turbolinks.Snapshot.wrap(xhr.response);\n\n      if (!location) {\n        location = window.location.href;\n      }\n\n      window.Turbolinks.controller.adapter.hideProgressBar();\n      window.Turbolinks.controller.cache.put(location, snapshot);\n      window.Turbolinks.visit(location, {action: 'restore'});\n      window.Turbolinks.clearCache();\n\n      if (xhr.status > 299) {\n        Turbolinks.controller.disable();\n      }\n    };\n\n    xhr.onerror = (event) => {\n      window.Turbolinks.controller.adapter.hideProgressBar();\n      this.uploadButton_.classList.toggle('dmc-profile-avatar__change--disabled');\n      this.showError('Request error');\n    };\n\n    window.Turbolinks.controller.adapter.showProgressBarAfterDelay();\n\n    canvas.toBlob((blob) => {\n      let formData = new FormData(this._formEl);\n      formData.append('avatar', blob, 'avatar.jpg');\n      xhr.send(formData);\n    });\n  }\n\n  _showError(message, timeout=2000) {\n    let snackbarEvent = new CustomEvent('DMCSnackbar:show', {\n      'detail': {message: message, timeout: timeout},\n    });\n    window.dispatchEvent(snackbarEvent);\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./material/components/dmc-profile-page/index.js","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Stimulus\"\n// module id = 3\n// module chunks = 0","/**\n * smartcrop.js\n * A javascript library implementing content aware image cropping\n *\n * Copyright (C) 2016 Jonas Wagner\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n * \"Software\"), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to\n * permit persons to whom the Software is furnished to do so, subject to\n * the following conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\n(function() {\n'use strict';\n\nvar smartcrop = {};\n// Promise implementation to use\nsmartcrop.Promise = typeof Promise !== 'undefined' ? Promise : function() {\n  throw new Error('No native promises and smartcrop.Promise not set.');\n};\n\nsmartcrop.DEFAULTS = {\n  width: 0,\n  height: 0,\n  aspect: 0,\n  cropWidth: 0,\n  cropHeight: 0,\n  detailWeight: 0.2,\n  skinColor: [0.78, 0.57, 0.44],\n  skinBias: 0.01,\n  skinBrightnessMin: 0.2,\n  skinBrightnessMax: 1.0,\n  skinThreshold: 0.8,\n  skinWeight: 1.8,\n  saturationBrightnessMin: 0.05,\n  saturationBrightnessMax: 0.9,\n  saturationThreshold: 0.4,\n  saturationBias: 0.2,\n  saturationWeight: 0.3,\n  // Step * minscale rounded down to the next power of two should be good\n  scoreDownSample: 8,\n  step: 8,\n  scaleStep: 0.1,\n  minScale: 1.0,\n  maxScale: 1.0,\n  edgeRadius: 0.4,\n  edgeWeight: -20.0,\n  outsideImportance: -0.5,\n  boostWeight: 100.0,\n  ruleOfThirds: true,\n  prescale: true,\n  imageOperations: null,\n  canvasFactory: defaultCanvasFactory,\n  // Factory: defaultFactories,\n  debug: false,\n};\n\n\n\nsmartcrop.crop = function(inputImage, options_, callback) {\n  var options = extend({}, smartcrop.DEFAULTS, options_);\n\n  if (options.aspect) {\n    options.width = options.aspect;\n    options.height = 1;\n  }\n\n  if (options.imageOperations === null) {\n    options.imageOperations = canvasImageOperations(options.canvasFactory);\n  }\n\n  var iop = options.imageOperations;\n\n  var scale = 1;\n  var prescale = 1;\n\n  return iop.open(inputImage, options.input).then(function(image) {\n\n    if (options.width && options.height) {\n      scale = min(image.width / options.width, image.height / options.height);\n      options.cropWidth = ~~(options.width * scale);\n      options.cropHeight = ~~(options.height * scale);\n      // Img = 100x100, width = 95x95, scale = 100/95, 1/scale > min\n      // don't set minscale smaller than 1/scale\n      // -> don't pick crops that need upscaling\n      options.minScale = min(options.maxScale, max(1 / scale, options.minScale));\n\n      if (options.prescale !== false) {\n        prescale = 1 / scale / options.minScale;\n        if (prescale < 1) {\n          image = iop.resample(image, image.width * prescale, image.height * prescale);\n          options.cropWidth = ~~(options.cropWidth * prescale);\n          options.cropHeight = ~~(options.cropHeight * prescale);\n          if (options.boost) {\n            options.boost = options.boost.map(function(boost) {\n              return {\n                x: ~~(boost.x * prescale),\n                y: ~~(boost.y * prescale),\n                width: ~~(boost.width * prescale),\n                height: ~~(boost.height * prescale),\n                weight: boost.weight\n              };\n            });\n          }\n        }\n        else {\n          prescale = 1;\n        }\n      }\n    }\n    return image;\n  })\n  .then(function(image) {\n    return iop.getData(image).then(function(data) {\n      var result = analyse(options, data);\n\n      var crops = result.crops || [result.topCrop];\n      for (var i = 0, iLen = crops.length; i < iLen; i++) {\n        var crop = crops[i];\n        crop.x = ~~(crop.x / prescale);\n        crop.y = ~~(crop.y / prescale);\n        crop.width = ~~(crop.width / prescale);\n        crop.height = ~~(crop.height / prescale);\n      }\n      if (callback) callback(result);\n      return result;\n    });\n  });\n};\n\n\n// Check if all the dependencies are there\n// todo:\nsmartcrop.isAvailable = function(options) {\n  if (!smartcrop.Promise) return false;\n\n  var canvasFactory = options ? options.canvasFactory : defaultCanvasFactory;\n\n  if (canvasFactory === defaultCanvasFactory) {\n    var c = document.createElement('canvas');\n    if (!c.getContext('2d')) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\nfunction edgeDetect(i, o) {\n  var id = i.data;\n  var od = o.data;\n  var w = i.width;\n  var h = i.height;\n\n  for (var y = 0; y < h; y++) {\n    for (var x = 0; x < w; x++) {\n      var p = (y * w + x) * 4;\n      var lightness;\n\n      if (x === 0 || x >= w - 1 || y === 0 || y >= h - 1) {\n        lightness = sample(id, p);\n      }\n      else {\n        lightness = sample(id, p) * 4 -\n            sample(id, p - w * 4) -\n            sample(id, p - 4) -\n            sample(id, p + 4) -\n            sample(id, p + w * 4);\n      }\n\n      od[p + 1] = lightness;\n    }\n  }\n}\n\nfunction skinDetect(options, i, o) {\n  var id = i.data;\n  var od = o.data;\n  var w = i.width;\n  var h = i.height;\n\n  for (var y = 0; y < h; y++) {\n    for (var x = 0; x < w; x++) {\n      var p = (y * w + x) * 4;\n      var lightness = cie(id[p], id[p + 1], id[p + 2]) / 255;\n      var skin = skinColor(options, id[p], id[p + 1], id[p + 2]);\n      var isSkinColor = skin > options.skinThreshold;\n      var isSkinBrightness = lightness >= options.skinBrightnessMin && lightness <= options.skinBrightnessMax;\n      if (isSkinColor && isSkinBrightness) {\n        od[p] = (skin - options.skinThreshold) * (255 / (1 - options.skinThreshold));\n      }\n      else {\n        od[p] = 0;\n      }\n    }\n  }\n}\n\nfunction saturationDetect(options, i, o) {\n  var id = i.data;\n  var od = o.data;\n  var w = i.width;\n  var h = i.height;\n  for (var y = 0; y < h; y++) {\n    for (var x = 0; x < w; x++) {\n      var p = (y * w + x) * 4;\n\n      var lightness = cie(id[p], id[p + 1], id[p + 2]) / 255;\n      var sat = saturation(id[p], id[p + 1], id[p + 2]);\n\n      var acceptableSaturation = sat > options.saturationThreshold;\n      var acceptableLightness = lightness >= options.saturationBrightnessMin &&\n          lightness <= options.saturationBrightnessMax;\n      if (acceptableLightness && acceptableLightness) {\n        od[p + 2] = (sat - options.saturationThreshold) * (255 / (1 - options.saturationThreshold));\n      }\n      else {\n        od[p + 2] = 0;\n      }\n    }\n  }\n}\n\nfunction applyBoosts(options, output) {\n  if (!options.boost) return;\n  var od = output.data;\n  for (var i = 0; i < output.width; i += 4) {\n    od[i + 3] = 0;\n  }\n  for (i = 0; i < options.boost.length; i++) {\n    applyBoost(options.boost[i], options, output);\n  }\n}\n\nfunction applyBoost(boost, options, output) {\n  var od = output.data;\n  var w = output.width;\n  var x0 = ~~boost.x;\n  var x1 = ~~(boost.x + boost.width);\n  var y0 = ~~boost.y;\n  var y1 = ~~(boost.y + boost.height);\n  var weight = boost.weight * 255;\n  for (var y = y0; y < y1; y++) {\n    for (var x = x0; x < x1; x++) {\n      var i = (y * w + x) * 4;\n      od[i + 3] += weight;\n    }\n  }\n}\n\nfunction generateCrops(options, width, height) {\n  var results = [];\n  var minDimension = min(width, height);\n  var cropWidth = options.cropWidth || minDimension;\n  var cropHeight = options.cropHeight || minDimension;\n  for (var scale = options.maxScale; scale >= options.minScale; scale -= options.scaleStep) {\n    for (var y = 0; y + cropHeight * scale <= height; y += options.step) {\n      for (var x = 0; x + cropWidth * scale <= width; x += options.step) {\n        results.push({\n          x: x,\n          y: y,\n          width: cropWidth * scale,\n          height: cropHeight * scale,\n        });\n      }\n    }\n  }\n  return results;\n}\n\nfunction score(options, output, crop) {\n  var result = {\n    detail: 0,\n    saturation: 0,\n    skin: 0,\n    boost: 0,\n    total: 0,\n  };\n\n  var od = output.data;\n  var downSample = options.scoreDownSample;\n  var invDownSample = 1 / downSample;\n  var outputHeightDownSample = output.height * downSample;\n  var outputWidthDownSample = output.width * downSample;\n  var outputWidth = output.width;\n\n  for (var y = 0; y < outputHeightDownSample; y += downSample) {\n    for (var x = 0; x < outputWidthDownSample; x += downSample) {\n      var p = (~~(y * invDownSample) * outputWidth + ~~(x * invDownSample)) * 4;\n      var i = importance(options, crop, x, y);\n      var detail = od[p + 1] / 255;\n\n      result.skin += od[p] / 255 * (detail + options.skinBias) * i;\n      result.detail += detail * i;\n      result.saturation += od[p + 2] / 255 * (detail + options.saturationBias) * i;\n      result.boost += od[p + 3] / 255 * i;\n    }\n  }\n\n  result.total = (result.detail * options.detailWeight +\n                  result.skin * options.skinWeight +\n                  result.saturation * options.saturationWeight +\n                  result.boost * options.boostWeight) / (crop.width * crop.height);\n  return result;\n}\n\nfunction importance(options, crop, x, y) {\n  if (crop.x > x || x >= crop.x + crop.width || crop.y > y || y >= crop.y + crop.height) {\n    return options.outsideImportance;\n  }\n  x = (x - crop.x) / crop.width;\n  y = (y - crop.y) / crop.height;\n  var px = abs(0.5 - x) * 2;\n  var py = abs(0.5 - y) * 2;\n  // Distance from edge\n  var dx = Math.max(px - 1.0 + options.edgeRadius, 0);\n  var dy = Math.max(py - 1.0 + options.edgeRadius, 0);\n  var d = (dx * dx + dy * dy) * options.edgeWeight;\n  var s = 1.41 - sqrt(px * px + py * py);\n  if (options.ruleOfThirds) {\n    s += (Math.max(0, s + d + 0.5) * 1.2) * (thirds(px) + thirds(py));\n  }\n  return s + d;\n}\nsmartcrop.importance = importance;\n\nfunction skinColor(options, r, g, b) {\n  var mag = sqrt(r * r + g * g + b * b);\n  var rd = (r / mag - options.skinColor[0]);\n  var gd = (g / mag - options.skinColor[1]);\n  var bd = (b / mag - options.skinColor[2]);\n  var d = sqrt(rd * rd + gd * gd + bd * bd);\n  return 1 - d;\n}\n\nfunction analyse(options, input) {\n  var result = {};\n  var output = new ImgData(input.width, input.height);\n\n  edgeDetect(input, output);\n  skinDetect(options, input, output);\n  saturationDetect(options, input, output);\n  applyBoosts(options, output);\n\n  var scoreOutput = downSample(output, options.scoreDownSample);\n\n  var topScore = -Infinity;\n  var topCrop = null;\n  var crops = generateCrops(options, input.width, input.height);\n\n  for (var i = 0, iLen = crops.length; i < iLen; i++) {\n    var crop = crops[i];\n    crop.score = score(options, scoreOutput, crop);\n    if (crop.score.total > topScore) {\n      topCrop = crop;\n      topScore = crop.score.total;\n    }\n\n  }\n\n  result.topCrop = topCrop;\n\n  if (options.debug && topCrop) {\n    result.crops = crops;\n    result.debugOutput = output;\n    result.debugOptions = options;\n    // Create a copy which will not be adjusted by the post scaling of smartcrop.crop\n    result.debugTopCrop = extend({}, result.topCrop);\n  }\n  return result;\n}\n\nfunction ImgData(width, height, data) {\n  this.width = width;\n  this.height = height;\n  if (data) {\n    this.data = new Uint8ClampedArray(data);\n  }\n  else {\n    this.data = new Uint8ClampedArray(width * height * 4);\n  }\n}\nsmartcrop.ImgData = ImgData;\n\nfunction downSample(input, factor) {\n  var idata = input.data;\n  var iwidth = input.width;\n  var width = Math.floor(input.width / factor);\n  var height = Math.floor(input.height / factor);\n  var output = new ImgData(width, height);\n  var data = output.data;\n  var ifactor2 = 1 / (factor * factor);\n  for (var y = 0; y < height; y++) {\n    for (var x = 0; x < width; x++) {\n      var i = (y * width + x) * 4;\n\n      var r = 0;\n      var g = 0;\n      var b = 0;\n      var a = 0;\n\n      var mr = 0;\n      var mg = 0;\n      var mb = 0;\n\n      for (var v = 0; v < factor; v++) {\n        for (var u = 0; u < factor; u++) {\n          var j = ((y * factor + v) * iwidth + (x * factor + u)) * 4;\n          r += idata[j];\n          g += idata[j + 1];\n          b += idata[j + 2];\n          a += idata[j + 3];\n          mr = Math.max(mr, idata[j]);\n          mg = Math.max(mg, idata[j + 1]);\n          mb = Math.max(mb, idata[j + 2]);\n        }\n      }\n      // this is some funky magic to preserve detail a bit more for\n      // skin (r) and detail (g). Saturation (b) does not get this boost.\n      data[i] = r * ifactor2 * 0.5 + mr * 0.5;\n      data[i + 1] = g * ifactor2 * 0.7 + mg * 0.3;\n      data[i + 2] = b * ifactor2;\n      data[i + 3] = a * ifactor2;\n    }\n  }\n  return output;\n}\nsmartcrop._downSample = downSample;\n\nfunction defaultCanvasFactory(w, h) {\n  var c = document.createElement('canvas');\n  c.width = w;\n  c.height = h;\n  return c;\n}\n\nfunction canvasImageOperations(canvasFactory) {\n  return {\n    // Takes imageInput as argument\n    // returns an object which has at least\n    // {width: n, height: n}\n    open: function(image) {\n      // Work around images scaled in css by drawing them onto a canvas\n      var w = image.naturalWidth || image.width;\n      var h = image.naturalHeight || image.height;\n      var c = canvasFactory(w, h);\n      var ctx = c.getContext('2d');\n      if (image.naturalWidth && (image.naturalWidth != image.width || image.naturalHeight != image.height)) {\n        c.width = image.naturalWidth;\n        c.height = image.naturalHeight;\n      }\n      else {\n        c.width = image.width;\n        c.height = image.height;\n      }\n      ctx.drawImage(image, 0, 0);\n      return smartcrop.Promise.resolve(c);\n    },\n    // Takes an image (as returned by open), and changes it's size by resampling\n    resample: function(image, width, height) {\n      return Promise.resolve(image).then(function(image) {\n        var c = canvasFactory(~~width, ~~height);\n        var ctx = c.getContext('2d');\n\n        ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, c.width, c.height);\n        return smartcrop.Promise.resolve(c);\n      });\n    },\n    getData: function(image) {\n      return Promise.resolve(image).then(function(c) {\n        var ctx = c.getContext('2d');\n        var id = ctx.getImageData(0, 0, c.width, c.height);\n        return new ImgData(c.width, c.height, id.data);\n      });\n    },\n  };\n}\nsmartcrop._canvasImageOperations = canvasImageOperations;\n\n// Aliases and helpers\nvar min = Math.min;\nvar max = Math.max;\nvar abs = Math.abs;\nvar ceil = Math.ceil;\nvar sqrt = Math.sqrt;\n\nfunction extend(o) {\n  for (var i = 1, iLen = arguments.length; i < iLen; i++) {\n    var arg = arguments[i];\n    if (arg) {\n      for (var name in arg) {\n        o[name] = arg[name];\n      }\n    }\n  }\n  return o;\n}\n\n// Gets value in the range of [0, 1] where 0 is the center of the pictures\n// returns weight of rule of thirds [0, 1]\nfunction thirds(x) {\n  x = ((x - (1 / 3) + 1.0) % 2.0 * 0.5 - 0.5) * 16;\n  return Math.max(1.0 - x * x, 0.0);\n}\n\nfunction cie(r, g, b) {\n  return 0.5126 * b + 0.7152 * g + 0.0722 * r;\n}\nfunction sample(id, p) {\n  return cie(id[p], id[p + 1], id[p + 2]);\n}\nfunction saturation(r, g, b) {\n  var maximum = max(r / 255, g / 255, b / 255);\n  var minumum = min(r / 255, g / 255, b / 255);\n\n  if (maximum === minumum) {\n    return 0;\n  }\n\n  var l = (maximum + minumum) / 2;\n  var d = maximum - minumum;\n\n  return l > 0.5 ? d / (2 - maximum - minumum) : d / (maximum + minumum);\n}\n\n// Amd\nif (typeof define !== 'undefined' && define.amd) define(function() {return smartcrop;});\n// Common js\nif (typeof exports !== 'undefined') exports.smartcrop = smartcrop;\n// Browser\nelse if (typeof navigator !== 'undefined') window.SmartCrop = window.smartcrop = smartcrop;\n// Nodejs\nif (typeof module !== 'undefined') {\n  module.exports = smartcrop;\n}\n})();\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/smartcrop/smartcrop.js\n// module id = 4\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Turbolinks\"\n// module id = 5\n// module chunks = 0"],"sourceRoot":""}